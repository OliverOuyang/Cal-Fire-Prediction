<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>California Fire Prediction System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            padding: 0;
            font-family: 'Poppins', sans-serif;
            background-color: #f0f2f5;
            color: #343a40;
        }
        .navbar {
            background: linear-gradient(135deg, #dc3545, #ff7043);
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
        }
        .navbar-brand {
            font-weight: 700;
            color: white;
        }
        .main-container {
            padding: 20px;
            margin-top: 20px;
        }
        .section {
            background-color: #ffffff;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            height: 100%;
            transition: all 0.3s ease;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        .section:hover {
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }
        .section-title {
            font-weight: 600;
            margin-bottom: 20px;
            color: #dc3545;
            border-bottom: 2px solid #f8d7da;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
        }
        .section-title i {
            margin-right: 8px;
        }
        #map {
            height: 400px;
            width: 100%;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .file-upload-container {
            border: 2px dashed #dee2e6;
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
            background-color: #f8f9fa;
            transition: all 0.3s ease;
        }
        .file-upload-container:hover {
            background-color: #e9ecef;
            border-color: #ced4da;
        }
        .file-upload-container i {
            font-size: 2.5rem;
            color: #6c757d;
            margin-bottom: 15px;
        }
        .probability-display {
            font-size: 3rem;
            font-weight: 700;
            text-align: center;
            margin: 25px 0;
            color: #dc3545;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
        }
        .input-group {
            margin-bottom: 15px;
        }
        .form-control, .form-select {
            border-radius: 8px;
            padding: 12px;
            border: 1px solid #ced4da;
            box-shadow: none;
            transition: all 0.2s;
        }
        .form-control:focus, .form-select:focus {
            border-color: #dc3545;
            box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25);
        }
        .form-floating > label {
            padding: 12px;
        }
        .btn {
            border-radius: 8px;
            padding: 10px 20px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
        }
        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #c82333);
            border: none;
            box-shadow: 0 4px 6px rgba(220, 53, 69, 0.2);
        }
        .btn-danger:hover {
            background: linear-gradient(135deg, #c82333, #bd2130);
            box-shadow: 0 6px 8px rgba(220, 53, 69, 0.3);
            transform: translateY(-2px);
        }
        .btn-outline-primary {
            border-color: #007bff;
            color: #007bff;
        }
        .btn-outline-primary:hover {
            background-color: #007bff;
            box-shadow: 0 4px 6px rgba(0, 123, 255, 0.2);
            transform: translateY(-2px);
        }
        .btn-primary {
            background: linear-gradient(135deg, #007bff, #0056b3);
            border: none;
            box-shadow: 0 4px 6px rgba(0, 123, 255, 0.2);
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #0069d9, #004494);
            box-shadow: 0 6px 8px rgba(0, 123, 255, 0.3);
            transform: translateY(-2px);
        }
        .btn-outline-secondary {
            border-color: #6c757d;
            color: #6c757d;
        }
        .btn-outline-secondary:hover {
            background-color: #6c757d;
            box-shadow: 0 4px 6px rgba(108, 117, 125, 0.2);
            transform: translateY(-2px);
        }
        #llm-analysis {
            background-color: #fff8e9;
            border-left: 4px solid #ffc107;
            padding: 20px;
            border-radius: 8px;
        }
        #llm-analysis h5 {
            color: #dc3545;
            margin-top: 15px;
            margin-bottom: 10px;
            font-weight: 600;
        }
        #llm-analysis p, #llm-analysis ul {
            color: #495057;
        }
        .map-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }
        .map-controls .btn {
            padding: 6px 12px;
            font-size: 0.85rem;
        }
        .results-card {
            border-radius: 12px;
            padding: 15px;
            background: linear-gradient(135deg, #ffeaee, #fff);
            border: 1px solid #f8d7da;
            transition: all 0.3s ease;
        }
        .results-card:hover {
            box-shadow: 0 8px 15px rgba(220, 53, 69, 0.1);
        }
        .gauge-container {
            position: relative;
            width: 150px;
            height: 150px;
            margin: 0 auto;
        }
        .gauge-ring {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(
                #dc3545 0% 62%, 
                #e9ecef 62% 100%
            );
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .gauge-inner {
            width: 70%;
            height: 70%;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.1);
        }
        .gauge-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #dc3545;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="bi bi-fire me-2"></i>
                California Fire Prediction System
            </a>
        </div>
    </nav>

    <div class="container main-container">
        <div class="row">
            <!-- Top Left: Satellite Imaging Section -->
            <div class="col-md-6 mb-4">
                <div class="section">
                    <h3 class="section-title">
                        <i class="bi bi-satellite"></i>
                        Satellite Image Analysis
                    </h3>
                    <div class="file-upload-container" id="satellite-upload">
                        <i class="bi bi-cloud-arrow-up"></i>
                        <p class="mb-0">Drop your satellite image here or click to upload</p>
                        <p class="text-muted small">Supports JPEG, PNG, TIFF formats</p>
                        <input type="file" id="satellite-file" class="d-none">
                    </div>
                    <div class="text-center">
                        <img id="preview-image" class="img-fluid d-none mb-3 rounded" style="max-height: 250px;">
                        <div id="satellite-result" class="d-none results-card">
                            <h4 class="text-center mb-3">Fire Probability</h4>
                            <div class="gauge-container">
                                <div class="gauge-ring">
                                    <div class="gauge-inner">
                                        <div class="gauge-value" id="satellite-probability-gauge">87%</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Top Right: California Fire Map -->
            <div class="col-md-6 mb-4">
                <div class="section">
                    <h3 class="section-title">
                        <i class="bi bi-map"></i>
                        California Fire Map
                    </h3>
                    <div id="map"></div>
                    <div class="map-controls">
                        <button class="btn btn-outline-danger me-2">
                            <i class="bi bi-fire"></i> Current Fires
                        </button>
                        <button class="btn btn-outline-secondary me-2">
                            <i class="bi bi-clock-history"></i> Historical
                        </button>
                        <button class="btn btn-outline-warning">
                            <i class="bi bi-exclamation-triangle"></i> Risk Areas
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <!-- Bottom Left: Fire Prediction Model -->
            <div class="col-md-6 mb-4">
                <div class="section">
                    <h3 class="section-title">
                        <i class="bi bi-calculator"></i>
                        Fire Prediction Model
                    </h3>
                    <div class="row mb-3">
                        <div class="col-md-8">
                            <div class="input-group">
                                <span class="input-group-text bg-white">
                                    <i class="bi bi-geo-alt"></i>
                                </span>
                                <input type="text" class="form-control" placeholder="Enter location (city, coordinates)">
                                <button class="btn btn-outline-primary">
                                    <i class="bi bi-search"></i>
                                </button>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <button class="btn btn-outline-secondary w-100">
                                <i class="bi bi-cursor"></i> Use My Location
                            </button>
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <button class="btn btn-primary w-100" id="fetch-weather">
                                <i class="bi bi-cloud-download"></i> Auto-fetch Weather
                            </button>
                        </div>
                        <div class="col-md-6">
                            <button class="btn btn-outline-secondary w-100" id="manual-entry">
                                <i class="bi bi-pencil-square"></i> Manual Entry
                            </button>
                        </div>
                    </div>
                    
                    <form id="prediction-form">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <input type="number" class="form-control" id="max_temp_c" placeholder="0" step="0.1">
                                    <label for="max_temp_c">Max Temp (°C)</label>
                                </div>
                                <div class="form-floating mb-3">
                                    <input type="number" class="form-control" id="min_temp_c" placeholder="0" step="0.1">
                                    <label for="min_temp_c">Min Temp (°C)</label>
                                </div>
                                <div class="form-floating mb-3">
                                    <input type="number" class="form-control" id="avg_temp_c" placeholder="0" step="0.1">
                                    <label for="avg_temp_c">Avg Temp (°C)</label>
                                </div>
                                <div class="form-floating mb-3">
                                    <input type="number" class="form-control" id="heating_deg_days_c" placeholder="0" step="0.1">
                                    <label for="heating_deg_days_c">Heating Degree Days</label>
                                </div>
                                <div class="form-floating mb-3">
                                    <input type="number" class="form-control" id="cooling_deg_days_c" placeholder="0" step="0.1">
                                    <label for="cooling_deg_days_c">Cooling Degree Days</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating mb-3">
                                    <input type="number" class="form-control" id="precip_mm" placeholder="0" step="0.1">
                                    <label for="precip_mm">Precipitation (mm)</label>
                                </div>
                                <div class="form-floating mb-3">
                                    <input type="number" class="form-control" id="avg_humidity" placeholder="0" step="0.1">
                                    <label for="avg_humidity">Avg Humidity (%)</label>
                                </div>
                                <div class="form-floating mb-3">
                                    <input type="number" class="form-control" id="avg_wind_speed_knots" placeholder="0" step="0.1">
                                    <label for="avg_wind_speed_knots">Wind Speed (knots)</label>
                                </div>
                                <div class="form-floating mb-3">
                                    <input type="number" class="form-control" id="avg_dew_point_f" placeholder="0" step="0.1">
                                    <label for="avg_dew_point_f">Dew Point (°F)</label>
                                </div>
                                <div class="form-floating mb-3">
                                    <input type="number" class="form-control" id="avg_visibility_km" placeholder="0" step="0.1">
                                    <label for="avg_visibility_km">Visibility (km)</label>
                                </div>
                                <div class="form-floating mb-3">
                                    <input type="number" class="form-control" id="avg_sea_level_pressure_mb" placeholder="0" step="0.1">
                                    <label for="avg_sea_level_pressure_mb">Sea Level Pressure (mb)</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-3">
                            <div class="col-12">
                                <button type="submit" class="btn btn-danger w-100">
                                    <i class="bi bi-calculator"></i> Calculate Fire Probability
                                </button>
                            </div>
                        </div>
                    </form>
                    
                    <div class="mt-4 d-none" id="model-result">
                        <h4 class="text-center mb-3">Calculated Fire Probability</h4>
                        <div class="gauge-container">
                            <div class="gauge-ring">
                                <div class="gauge-inner">
                                    <div class="gauge-value" id="model-probability">62%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Bottom Right: Date Selector -->
            <div class="col-md-6 mb-4">
                <div class="section">
                    <h3 class="section-title">
                        <i class="bi bi-calendar-date"></i>
                        Date Selection & Controls
                    </h3>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-floating mb-3">
                                <input type="date" class="form-control" id="date-selector">
                                <label for="date-selector">Select Date</label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-floating mb-3">
                                <select class="form-select" id="map-layer">
                                    <option value="current">Current Fires</option>
                                    <option value="historical">Historical Fires</option>
                                    <option value="risk">Fire Risk Zones</option>
                                    <option value="all">All Layers</option>
                                </select>
                                <label for="map-layer">Map Layer</label>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-6">
                            <button class="btn btn-outline-primary w-100" id="apply-map-filters">
                                <i class="bi bi-filter"></i> Apply to Map
                            </button>
                        </div>
                        <div class="col-6">
                            <button class="btn btn-primary w-100" id="apply-date-filter">
                                <i class="bi bi-calendar-check"></i> Get Weather for Date
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Full Width: AI Analysis Section -->
        <div class="row">
            <div class="col-12 mb-4">
                <div class="section">
                    <h3 class="section-title">
                        <i class="bi bi-robot"></i>
                        AI Analysis
                    </h3>
                    <div id="llm-analysis">
                        <h5><i class="bi bi-exclamation-triangle-fill text-warning me-2"></i>Fire Risk Assessment</h5>
                        <p>Based on the current location and weather conditions, there is a <strong>moderate to high risk</strong> of wildfire. The combination of high temperatures (32°C), low precipitation (2.3mm), and moderate wind speeds (8 knots) create favorable conditions for fire ignition and spread.</p>
                        
                        <h5><i class="bi bi-list-check text-primary me-2"></i>Contributing Factors</h5>
                        <ul>
                            <li>Elevated temperatures above seasonal norms</li>
                            <li>Low humidity levels (28%)</li>
                            <li>Extended period without significant rainfall</li>
                        </ul>
                        
                        <h5><i class="bi bi-lightbulb text-success me-2"></i>Recommended Actions</h5>
                        <p>Monitor local fire warnings and adhere to any restrictions on outdoor activities. Ensure defensible space around structures, and prepare emergency evacuation plans. The risk is projected to remain elevated for the next 48-72 hours.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
    <script>
        // Initialize the map
        const map = L.map('map').setView([37.8, -122.0], 6);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);
        
        // Add sample fire perimeters (in a real app, this would come from an API)
        const sampleFires = [
            {name: "Sample Fire 1", coords: [[37.5, -122.3], [37.7, -122.2], [37.6, -122.0], [37.4, -122.1]]},
            {name: "Sample Fire 2", coords: [[38.1, -120.8], [38.3, -120.7], [38.2, -120.5], [38.0, -120.6]]}
        ];
        
        sampleFires.forEach(fire => {
            L.polygon(fire.coords, {color: 'red', fillOpacity: 0.5})
             .bindPopup(`<strong>${fire.name}</strong><br>Active Fire Zone`)
             .addTo(map);
        });
        
        // Satellite image upload preview
        document.getElementById('satellite-upload').addEventListener('click', () => {
            document.getElementById('satellite-file').click();
        });
        
        document.getElementById('satellite-file').addEventListener('change', function(e) {
            if(e.target.files && e.target.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const previewImage = document.getElementById('preview-image');
                    previewImage.src = e.target.result;
                    previewImage.classList.remove('d-none');
                    
                    // Show fake results (in a real app, this would call an API)
                    setTimeout(() => {
                        document.getElementById('satellite-result').classList.remove('d-none');
                        
                        // Update gauge graphic
                        const probability = 87;
                        document.getElementById('satellite-probability-gauge').textContent = probability + '%';
                        const gaugeRing = document.getElementById('satellite-result').querySelector('.gauge-ring');
                        gaugeRing.style.background = `conic-gradient(#dc3545 0% ${probability}%, #e9ecef ${probability}% 100%)`;
                    }, 1500);
                }
                reader.readAsDataURL(e.target.files[0]);
            }
        });
        
        // Form submission
        document.getElementById('prediction-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // In a real app, this would send data to the API
            const formData = {
                max_temp_c: parseFloat(document.getElementById('max_temp_c').value),
                min_temp_c: parseFloat(document.getElementById('min_temp_c').value),
                avg_temp_c: parseFloat(document.getElementById('avg_temp_c').value),
                heating_deg_days_c: parseFloat(document.getElementById('heating_deg_days_c').value),
                cooling_deg_days_c: parseFloat(document.getElementById('cooling_deg_days_c').value),
                precip_mm: parseFloat(document.getElementById('precip_mm').value),
                avg_humidity: parseFloat(document.getElementById('avg_humidity').value),
                avg_wind_speed_knots: parseFloat(document.getElementById('avg_wind_speed_knots').value),
                avg_dew_point_f: parseFloat(document.getElementById('avg_dew_point_f').value),
                avg_visibility_km: parseFloat(document.getElementById('avg_visibility_km').value),
                avg_sea_level_pressure_mb: parseFloat(document.getElementById('avg_sea_level_pressure_mb').value)
            };
            
            // Simulating API call - in a real app would be fetch('/predict', {...})
            console.log('Would send to API:', formData);
            
            // Show results (simulated)
            document.getElementById('model-result').classList.remove('d-none');
            
            // In a real app, this would come from the API response
            const probability = Math.round(Math.random() * 100);
            document.getElementById('model-probability').textContent = probability + '%';
            
            // Update gauge graphic
            const gaugeRing = document.getElementById('model-result').querySelector('.gauge-ring');
            gaugeRing.style.background = `conic-gradient(#dc3545 0% ${probability}%, #e9ecef ${probability}% 100%)`;
        });
        
        // Toggle between auto-fetch and manual
        document.getElementById('fetch-weather').addEventListener('click', function() {
            // In a real app, this would fetch weather data from an API
            alert('In a real application, this would fetch current weather data from a weather API based on the selected location.');
            
            // Fill the form with sample data
            document.getElementById('max_temp_c').value = '32.5';
            document.getElementById('min_temp_c').value = '18.2';
            document.getElementById('avg_temp_c').value = '25.8';
            document.getElementById('heating_deg_days_c').value = '0';
            document.getElementById('cooling_deg_days_c').value = '10.8';
            document.getElementById('precip_mm').value = '2.3';
            document.getElementById('avg_humidity').value = '28';
            document.getElementById('avg_wind_speed_knots').value = '8';
            document.getElementById('avg_dew_point_f').value = '45.2';
            document.getElementById('avg_visibility_km').value = '15.7';
            document.getElementById('avg_sea_level_pressure_mb').value = '1012.5';
        });
        
        // Handle date filter application
        document.getElementById('apply-date-filter').addEventListener('click', function() {
            const dateSelector = document.getElementById('date-selector');
            const selectedDate = dateSelector.value;
            
            if (!selectedDate) {
                alert('Please select a date first');
                return;
            }
            
            alert(`In a real application, this would fetch historical weather data for ${selectedDate} to analyze past fire conditions. This is useful for studying events like major wildfires.`);
            
            // In a real app, this would call the API with the date parameter
            // and then update the form fields with the returned historical data
        });
        
        // Handle map filter application
        document.getElementById('apply-map-filters').addEventListener('click', function() {
            const mapLayer = document.getElementById('map-layer').value;
            const dateSelector = document.getElementById('date-selector').value;
            
            alert(`In a real application, this would update the map to show ${mapLayer} data${dateSelector ? ' for ' + dateSelector : ''}`);
            
            // In a real app, this would update the map layers based on selection
        });
    </script>
</body>
</html> 